# –°–µ—Ä–≤–∏—Å API

–°–µ—Ä–≤–∏—Å —Å–ª—É–∂–∏—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –≤–Ω–µ—à–Ω–∏–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏ –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø—É REST API.
–ü—Ä–æ–µ–∫—Ç –Ω–∞–ø–∏—Å–∞–Ω –Ω–∞ Python 3.14 + UV

## –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

- FastAPI - –û—Å–Ω–æ–≤–Ω–æ–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ HTTP
- SqlAlchemy - ORM –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- Aio-Pika - –†–∞–±–æ—Ç–∞ —Å RabbitMQ
- Redis - –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ + –ª–∏–º–∏—Ç –ø–æ –∑–∞–ø—Ä–æ—Å–∞–º
- Pydantic - –í–∞–ª–∏–¥–∞—Ü–∏—è/—Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- Alembic - –º–∏–≥—Ä–∞—Ü–∏—è


## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```sh
api/
‚îú‚îÄ‚îÄ üìÅ database/
‚îÇ   ‚îú‚îÄ‚îÄ connection.py            # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –ë–î
‚îÇ   ‚îî‚îÄ‚îÄ query.py                 # –ó–∞–ø—Ä–æ—Å—ã –≤ –ë–î
‚îú‚îÄ‚îÄ üìÅ helpers/                  # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –ø–æ –ø—Ä–æ–µ–∫—Ç—É
‚îÇ   ‚îú‚îÄ‚îÄ auth.py                  # –†–∞–±–æ—Ç–∞ —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π –∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ enums.py                 # Enum –º–æ–¥–µ–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ hashers.py               # –ê–ª–≥–æ—Ä–∏—Ç–º—ã –∏ –ø—Ä–∞–≤–∏–ª–∞ —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ logger.py                # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îÇ   ‚îî‚îÄ‚îÄ orjson_coder.py          # –ö–æ–¥–∏—Ä–æ–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ üìÅ migrations/               # Alembic –º–∏–≥—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ üìÅ models/                   # –ú–æ–¥–µ–ª–∏ SqlAlchemy -> Users, Orders
‚îú‚îÄ‚îÄ üìÅ rabbit_core/              # –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã —Å RabbitMQ
‚îÇ   ‚îî‚îÄ‚îÄ client.py                # –û–±—â–∏–π –∫–ª–∏–µ–Ω—Ç —Ä–∞–±–æ—Ç—ã —Å RabbitMQ
‚îú‚îÄ‚îÄ üìÅ redis_core/               # –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã —Å Redis
‚îÇ   ‚îú‚îÄ‚îÄ client.py                # –û–±—â–∏–π –∫–ª–∏–µ–Ω—Ç —Ä–∞–±–æ—Ç—ã —Å Redis
‚îÇ   ‚îú‚îÄ‚îÄ lua_script.py            # –û–ø–∏—Å–∞–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω–æ–≥–æ —Å–∫—Ä–∏–ø—Ç—ã lua
‚îÇ   ‚îî‚îÄ‚îÄ rate_limiter.py          # –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤
‚îú‚îÄ‚îÄ üìÅ routers/                  # –û—Å–Ω–æ–≤–Ω—ã–µ –ø—É—Ç–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–∏ —Å —Å–µ—Ä–≤–µ—Ä–æ–º –ø–æ HTTP
‚îÇ   ‚îú‚îÄ‚îÄ auth.py                  # –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è + –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (–¢–æ–∫–µ–Ω)
‚îÇ   ‚îú‚îÄ‚îÄ orders.py                # –ó–∞–∫–∞–∑—ã
‚îÇ   ‚îú‚îÄ‚îÄ ping.py                  # –û–±—â–∏–π healthcheck —Å–∏—Å—Ç–µ–º—ã
‚îÇ   ‚îî‚îÄ‚îÄ redirect.py              # –ü–µ—Ä–µ–≤–æ–¥ –∑–∞–ø—Ä–æ—Å–æ–≤
‚îú‚îÄ‚îÄ üìÅ schemas/                  # –°—Ö–µ–º—ã Pydantic
‚îú‚îÄ‚îÄ configs.py                   # –ú–æ–¥—É–ª—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏ –ø–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è .env
‚îú‚îÄ‚îÄ Dockerfile                   # –ü—Ä–∞–≤–∏–ª–∞ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è –¥–æ–∫–µ—Ä –æ–±—Ä–∞–∑–∞
‚îú‚îÄ‚îÄ main.py                      # –ú–æ–¥—É–ª—å –∑–∞–ø—É—Å–∫–∞
‚îú‚îÄ‚îÄ .env.local                   # –ü—Ä–∏–º–µ—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îî‚îÄ‚îÄ pyproject.toml               # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞
```

## –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–π –æ–∫—Ä—É–∂–µ–Ω–∏—è

```sh
# –ö–æ–Ω—Ñ–∏–≥–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Postgres
POSTGRES_HOST=localhost
POSTGRES_PORT=5435
POSTGRES_DB=orders
POSTGRES_PASSWORD=LyhaEkM2D6TeH96W8jxG
POSTGRES_USER=orders_user
PGUSER=orders_user
POSTGRES_TRANSACTION_TIMEOUT=30
POSTGRES_ECHO=true

# –ö–æ–Ω—Ñ–∏–≥–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ RabbitMQ
RMQ_USER=user
RMQ_PASSWORD=bitnami
RMQ_HOST=localhost
RMQ_PORT=5672
RMQ_VHOST=%2f
RMQ_PARAMS=connection_attempts=3&heartbeat=60
RMQ_EXCHANGE=test
RMQ_QUEUE=test

# –ö–æ–Ω—Ñ–∏–≥–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Redis
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=12345
REDIS_USER=user
REDIS_USER_PASSWORD=12345
REDIS_TTL_EXPIRE=30

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¢–æ–∫–µ–Ω–∞
JWT_SECRET_KEY="Somesecretkey" # –°–µ–∫—Ä–µ—Ç–∞ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏ —Ç–æ–∫–µ–Ω–∞
JWT_ALGORITHM="HS256" # –ê–ª–≥–æ—Ä–∏—Ç–º–∞ –∫–æ–¥–∏—Ä–æ–≤–∫–∏ —Ç–æ–∫–µ–Ω–∞
JWT_LIFETIME=10 # –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ —Ç–æ–∫–µ–Ω–∞ –≤ –º–∏–Ω—É—Ç–∞—Ö

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞
ENV_ALLOWED_ORIGINS="*"

LOGLEVEL=INFO
```
